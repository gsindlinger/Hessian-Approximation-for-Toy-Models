base_output_dir: experiments/sweep_1/data/
dataset:
  name: digits
  path: experiments/sweep_1/data/datasets/digits
  split_seed: 42
  store_on_disk: true
  test_size: 0.1
experiment_name: ''
hessian_analysis:
  accuracy_threshold: 0.4
  base_collector_dir: experiments/sweep_1/data/collector
  base_ekfac_dir: experiments/sweep_1/data/ekfac
  computation_config:
    approximators:
    - gnh
    - block_hessian
    - fim
    - kfac
    - ekfac
    comparison_references:
    - exact
    - gnh
    computation_types:
    - hvp
    - ihvp
    damping: 0.1
    damping_strategy: auto_mean_eigenvalue
  matrix_config:
    metrics:
    - frobenius
    - relative_frobenius
    - spectral
    - spectral_relative
    - cosine_similarity
    - trace_distance
    - condition_number_log_ratio
  results_output_dir: experiments/results
  vector_config:
    metrics:
    - absolute_l2_diff
    - relative_error
    - cosine_similarity
    - inner_product_diff
    - relative_energy_diff
    - inner_product_ratio
    num_samples: 1000
    sampling_method: gradients
    seed: 42
models:
- architecture: mlp
  directory: null
  hidden_dim:
  - 16
  init_seed: 42
  loss: cross_entropy
  skip_existing: true
  training:
    batch_size: 128
    epochs: 500
    learning_rate: 0.001
    optimizer: adamw
    weight_decay: 0.0
- architecture: mlp
  directory: null
  hidden_dim:
  - 16
  - 16
  - 16
  - 16
  init_seed: 42
  loss: cross_entropy
  skip_existing: true
  training:
    batch_size: 128
    epochs: 500
    learning_rate: 0.001
    optimizer: adamw
    weight_decay: 0.0
- architecture: mlp
  directory: null
  hidden_dim:
  - 16
  - 16
  - 16
  - 16
  - 16
  - 16
  - 16
  - 16
  init_seed: 42
  loss: cross_entropy
  skip_existing: true
  training:
    batch_size: 128
    epochs: 500
    learning_rate: 0.001
    optimizer: adamw
    weight_decay: 0.0
run_hessian_analysis: true
seed: 42
